{"version":3,"sources":["webpack:///./src/views/post/Editor.vue","webpack:///./src/views/post/Editor.vue?6e95","webpack:///./src/views/post/Editor.vue?5e8e"],"names":["class","_createElementVNode","selected","disabled","hidden","value","for","_hoisted_25","required","onChange","_ctx","_hoisted_5","_createElementBlock","_Fragment","_renderList","Object","keys","groupMenus","main","key","_hoisted_6","mainMenus","length","_hoisted_9","menu","_id","sub","_hoisted_10","subMenu","categories","_hoisted_13","category","_hoisted_14","_createVNode","_component_Toggle","isPublic","onUpdateIsPublic","type","title","$event","placeholder","onfocus","onblur","_hoisted_19","ref","id","onClick","UPLOAD_INPUT_EL","multiple","content","onKeydown","_component_markdown","source","plugins","breaks","xhtmlOut","typographer","files","file","index","serverFileName","src","fileIndex","_component_Button","size","borderColor","rounded","full","isLoading","onOnClick","bgColor","custom","_component_Dialog","defineComponent","name","components","Toggle","Markdown","setup","route","useRoute","go","push","useRouter","state","commit","dispatch","useStore","canLeavePage","isMobile","useMedia","Dialog","plugin","MarkdownEmoji","IMAGE_URL","process","menuState","reactive","computed","loading","percentage","postState","postId","draftId","images","fileState","map","thumbnail","fileId","tempFiles","FormData","fileName","fileUrl","onChangeMainMenu","event","target","document","body","querySelector","selectedIndex","onChangeSubMenu","find","onChangeCategory","onChangeIsPublic","Boolean","onUpdateDraft","async","formData","payload","forEach","append","success","draft","onUpdatePost","alert","post","query","onUploadImages","values","concat","onSelectImage","onDeleteImage","imageId","idx","indexOf","filter","onInsertImage","textarea","start","substring","selectionStart","end","selectionEnd","innerText","focus","onClearImages","onChangeCanLeavePage","bool","unloadEvent","preventDefault","returnValue","setInitData","temp","Array","isArray","findIndex","autoSave","setInterval","onBeforeMount","onMounted","window","addEventListener","menus","m","onUnmounted","removeEventListener","clearInterval","onBeforeRouteLeave","to","from","next","ok","show","message","okButton","cancelButton","__exports__","render"],"mappings":"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","file":"js/editor.9c6065fa.js","sourcesContent":["<template>\r\n  <div class=\"editor\">\r\n    <div class=\"wrap_select_toggle\">\r\n      <div class=\"select\">\r\n        <div class=\"main\">\r\n          <select required @change=\"onChangeMainMenu\">\r\n            <option selected disabled hidden value=\"\">main menu</option>\r\n            <option v-for=\"main in Object.keys(menuState.groupMenus)\" :key=\"main\" :value=\"main\">{{ main }}</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"sub\">\r\n          <select required :disabled=\"!menuState.mainMenus.length\" @change=\"onChangeSubMenu\">\r\n            <option selected disabled hidden value=\"\">sub menu</option>\r\n            <option v-for=\"menu in menuState.mainMenus\" :key=\"menu?._id\" :value=\"menu?.sub\">{{ menu?.sub }}</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"category\">\r\n          <select :disabled=\"!menuState.subMenu.categories\" @change=\"onChangeCategory\">\r\n            <option selected disabled hidden value=\"\">category</option>\r\n            <option v-for=\"category in menuState.subMenu.categories\" :key=\"category\" :value=\"category\">\r\n              {{ category }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"wrap_toggle\">\r\n        <Toggle :isPublic=\"postState.isPublic\" @updateIsPublic=\"onChangeIsPublic\" />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"wrap_title_file-add-btn\">\r\n      <div class=\"title\">\r\n        <input\r\n          type=\"text\"\r\n          v-model=\"postState.title\"\r\n          placeholder=\"제목을 입력하세요.\"\r\n          onfocus=\"this.placeholder=''\"\r\n          onblur=\"this.placeholder='제목을 입력하세요.'\"\r\n        />\r\n      </div>\r\n      <div class=\"images_add_btn\">\r\n        <label for=\"upload_input\" class=\"upload_label\">사진 불러오기</label>\r\n        <input\r\n          ref=\"UPLOAD_INPUT_EL\"\r\n          type=\"file\"\r\n          id=\"upload_input\"\r\n          @change=\"onUploadImages\"\r\n          @click=\"$refs.UPLOAD_INPUT_EL.value = ''\"\r\n          multiple\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"content\">\r\n      <textarea\r\n        id=\"content-el\"\r\n        v-model=\"postState.content\"\r\n        placeholder=\"당신의 이야기를 적어보세요...\"\r\n        @keydown=\"onChangeCanLeavePage(false)\"\r\n      />\r\n      <markdown\r\n        class=\"markdown\"\r\n        :source=\"postState.content\"\r\n        :plugins=\"plugins\"\r\n        :breaks=\"true\"\r\n        :xhtmlOut=\"true\"\r\n        :typographer=\"true\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"images\" v-if=\"fileState.files.length\">\r\n      <ul>\r\n        <li v-for=\"(file, index) in fileState.files\" :key=\"file.serverFileName\">\r\n          <div class=\"wrap_thumbnail\">\r\n            <img\r\n              :src=\"`${IMAGE_URL}${file.serverFileName}`\"\r\n              :class=\"fileState.fileIndex === index ? 'selected_thumbnail' : ''\"\r\n              @click=\"onSelectImage(file, index)\"\r\n            />\r\n            <button class=\"image_del_btn\" @click=\"onDeleteImage(file, index)\">\r\n              <i class=\"material-symbols-outlined\"> do_not_disturb_on </i>\r\n            </button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"wrap_btns\">\r\n      <div class=\"wrap_image_btns\">\r\n        <Button\r\n          v-show=\"fileState.files.length\"\r\n          class=\"btn_image_insert\"\r\n          :content=\"'사진 첨부'\"\r\n          :size=\"'md'\"\r\n          :borderColor=\"'primary-dark'\"\r\n          :rounded=\"true\"\r\n          :full=\"isMobile ? true : false\"\r\n          :disabled=\"menuState.isLoading\"\r\n          @onClick=\"onInsertImage\"\r\n        ></Button>\r\n        <Button\r\n          v-show=\"fileState.files.length\"\r\n          class=\"btn_image_clear\"\r\n          :content=\"'사진 모두 제거'\"\r\n          :size=\"'md'\"\r\n          :borderColor=\"'primary-dark'\"\r\n          :rounded=\"true\"\r\n          :full=\"isMobile ? true : false\"\r\n          :disabled=\"menuState.isLoading\"\r\n          @onClick=\"onClearImages\"\r\n        ></Button>\r\n      </div>\r\n\r\n      <Button\r\n        class=\"btn_submit\"\r\n        :content=\"'글 등록'\"\r\n        :size=\"'md'\"\r\n        :bgColor=\"'primary-dark'\"\r\n        :custom=\"true\"\r\n        :rounded=\"true\"\r\n        :full=\"isMobile ? true : false\"\r\n        :disabled=\"menuState.isLoading\"\r\n        @onClick=\"onChangeCanLeavePage(true), onUpdatePost()\"\r\n      ></Button>\r\n\r\n      <!--\r\n      <div class=\"wrap_right\">\r\n        <div class=\"wrap_isLoading\">\r\n          <Transition name=\"isLoading\">\r\n            <span class=\"isLoading\" v-if=\"menuState.isLoading\">\r\n              <i class=\"material-symbols-outlined\">hourglass_empty</i>{{ `자동 저장중...${menuState.percentage}` }}\r\n            </span>\r\n          </Transition>\r\n        </div>\r\n      </div>\r\n      -->\r\n    </div>\r\n  </div>\r\n  <Dialog ref=\"Dialog\"></Dialog>\r\n</template>\r\n\r\n<script>\r\n  import { defineComponent, ref, reactive, computed, onBeforeMount, onMounted, onUnmounted } from 'vue'\r\n  import { useRouter, useRoute, onBeforeRouteLeave } from 'vue-router'\r\n  import { useStore } from 'vuex'\r\n  import { useMedia } from '../../common/mediaQuery'\r\n  import Markdown from 'vue3-markdown-it'\r\n  import MarkdownEmoji from 'markdown-it-emoji'\r\n  import Toggle from '../../components/global/Toggle.vue'\r\n  import 'highlight.js/styles/atom-one-dark.css'\r\n\r\n  export default defineComponent({\r\n    name: 'editor',\r\n    components: {\r\n      Toggle,\r\n      Markdown,\r\n    },\r\n    setup() {\r\n      const route = useRoute()\r\n      const { go, push } = useRouter()\r\n      const { state, commit, dispatch } = useStore()\r\n\r\n      let canLeavePage = true\r\n      const isMobile = useMedia('only screen and (max-width: 767px)')\r\n      const Dialog = ref(null)\r\n      const plugins = ref([{ plugin: MarkdownEmoji }])\r\n      const IMAGE_URL = ref(process.env.VUE_APP_IMAGE_URL)\r\n\r\n      const menuState = reactive({\r\n        isLoading: computed(() => state.loading.isLoading),\r\n        percentage: computed(() => state.loading.percentage),\r\n        groupMenus: computed(() => state.menu.groupMenus),\r\n        mainMenus: [],\r\n        subMenu: {},\r\n      })\r\n\r\n      const postState = reactive({\r\n        postId: '',\r\n        draftId: '',\r\n        menu: '',\r\n        title: '',\r\n        content: '',\r\n        category: '기타',\r\n        isPublic: true,\r\n        images: computed(() => fileState.files.map((file) => file._id)),\r\n        thumbnail: computed(() => fileState.fileId),\r\n      })\r\n\r\n      const fileState = reactive({\r\n        tempFiles: new FormData(),\r\n        files: [],\r\n        fileId: '',\r\n        fileName: '',\r\n        fileUrl: 'http://localhost:3000/uploads/',\r\n        fileIndex: 0,\r\n      })\r\n\r\n      const onChangeMainMenu = (event) => {\r\n        menuState.mainMenus = menuState.groupMenus[event.target.value]\r\n        document.body.querySelector('div.sub select').selectedIndex = 0\r\n        document.body.querySelector('div.category select').selectedIndex = 0\r\n      }\r\n\r\n      const onChangeSubMenu = (event) => {\r\n        menuState.subMenu = menuState.mainMenus.find((menu) => menu.sub === event.target.value)\r\n        postState.menu = menuState.subMenu?._id\r\n        document.body.querySelector('div.category select').selectedIndex = 0\r\n      }\r\n\r\n      const onChangeCategory = (event) => {\r\n        postState.category = event.target.value\r\n      }\r\n\r\n      const onChangeIsPublic = (state) => {\r\n        postState.isPublic = Boolean(state)\r\n      }\r\n\r\n      const onUpdateDraft = async (formData = new FormData()) => {\r\n        if (!postState.menu) return\r\n\r\n        const { draftId, postId, ...payload } = postState\r\n        Object.keys(payload).forEach((key) => formData.append(key, payload[key]))\r\n\r\n        const { success, draft, images } = draftId\r\n          ? await dispatch('draft/updateDraft', { draftId, payload: formData })\r\n          : await dispatch('draft/createDraft', formData)\r\n\r\n        if (draft) postState.draftId = draft._id\r\n        return { success, images }\r\n      }\r\n\r\n      const onUpdatePost = async () => {\r\n        if (!postState.menu) return alert('게시글을 삽입할 메뉴를 선택해야 합니다.')\r\n\r\n        const { draftId, postId, ...payload } = postState\r\n        const { success, post } = postId\r\n          ? await dispatch('post/updatePost', { postId, payload })\r\n          : await dispatch('post/createPost', payload)\r\n\r\n        if (success && canLeavePage) {\r\n          push({ name: 'post', query: { id: post._id } })\r\n        }\r\n      }\r\n\r\n      const onUploadImages = async (event) => {\r\n        if (!event.target.files.length) return\r\n        if (!postState.menu) return alert('게시글을 삽입할 메뉴를 선택해야 합니다.')\r\n\r\n        const formData = new FormData()\r\n        Object.values(event.target.files).forEach((file) => formData.append('images', file))\r\n\r\n        const { success, images } = postState.postId\r\n          ? await dispatch('post/updatePost', { postId: postState.postId, payload: formData })\r\n          : await onUpdateDraft(formData)\r\n\r\n        if (success && images) {\r\n          fileState.files = fileState.files.concat(images)\r\n          onSelectImage(fileState.files[0], 0)\r\n        }\r\n      }\r\n\r\n      const onDeleteImage = async (file) => {\r\n        if (!file?._id) return\r\n\r\n        const { success } = postState.postId\r\n          ? await dispatch('post/deleteFile', { postId: postState.postId, imageId: file._id })\r\n          : await dispatch('draft/deleteFile', { draftId: postState.draftId, imageId: file._id })\r\n\r\n        const idx = fileState.files.indexOf(file)\r\n        if (success && idx !== -1) fileState.files = fileState.files.filter((file, index) => index !== idx)\r\n      }\r\n\r\n      const onSelectImage = (file, index) => {\r\n        if (file) {\r\n          fileState.fileId = file._id\r\n          fileState.fileName = file.serverFileName\r\n          fileState.fileUrl = fileState.fileUrl + fileState.fileName\r\n          fileState.fileIndex = index\r\n        }\r\n      }\r\n\r\n      const onInsertImage = () => {\r\n        let textarea = document.body.querySelector('#content-el')\r\n        let start = textarea.value.substring(0, textarea.selectionStart)\r\n        let end = textarea.value.substring(textarea.selectionEnd, textarea.value.length)\r\n\r\n        const innerText = `!` + `[` + `]` + `(` + `${fileState.fileUrl}` + `)\\n`\r\n        postState.content = start + innerText + end\r\n        textarea.focus()\r\n      }\r\n\r\n      const onClearImages = () => {\r\n        fileState.files = []\r\n      }\r\n\r\n      const onChangeCanLeavePage = (bool) => {\r\n        canLeavePage = bool\r\n      }\r\n\r\n      const unloadEvent = (event) => {\r\n        if (!canLeavePage) {\r\n          event.preventDefault()\r\n          event.returnValue = ''\r\n        }\r\n      }\r\n\r\n      const setInitData = (post, temp = false) => {\r\n        const { _id, menu, category, title, content, isPublic, images, thumbnail } = post\r\n\r\n        if (temp) postState.draftId = _id\r\n        else postState.postId = _id\r\n\r\n        postState.menu = menu\r\n        postState.title = title\r\n        postState.content = content\r\n        postState.category = category\r\n        postState.isPublic = isPublic\r\n        fileState.files = Array.isArray(images) ? images : []\r\n\r\n        const idx = fileState.files.findIndex((file) => file._id === thumbnail)\r\n        if (thumbnail && idx !== -1) {\r\n          onSelectImage(fileState.files[idx], idx)\r\n        }\r\n      }\r\n\r\n      const autoSave = route.query.id\r\n        ? setInterval(onUpdatePost, 1000 * 60 * 10)\r\n        : setInterval(onUpdateDraft, 1000 * 60 * 10)\r\n\r\n      onBeforeMount(() => {\r\n        const { post } = state.post\r\n        const { draft } = state.draft\r\n\r\n        if (route.query.id) {\r\n          if (post._id) setInitData(post)\r\n          else if (draft._id) setInitData(draft, true)\r\n          else go(-1)\r\n        }\r\n      })\r\n\r\n      onMounted(() => {\r\n        window.addEventListener('beforeunload', unloadEvent)\r\n        const { menu, category } = postState\r\n\r\n        if (menu) {\r\n          const { main, sub } = state.menu.menus.find((m) => m._id === menu)\r\n\r\n          document.body.querySelector('div.main select').value = main\r\n          menuState.mainMenus = menuState.groupMenus[main]\r\n\r\n          document.body.querySelector('div.sub select').value = sub\r\n          menuState.subMenu = menuState.mainMenus.find((menu) => menu.sub === sub)\r\n\r\n          if (category) document.body.querySelector('div.category select').value = category\r\n        }\r\n      })\r\n\r\n      onUnmounted(async () => {\r\n        window.removeEventListener('beforeunload', unloadEvent)\r\n        clearInterval(autoSave)\r\n        commit('draft/SET_DRAFT', {})\r\n      })\r\n\r\n      onBeforeRouteLeave(async (to, from, next) => {\r\n        if (canLeavePage) next()\r\n        else {\r\n          const ok = await Dialog.value.show({\r\n            title: '현재 페이지에서 나가시겠습니까?',\r\n            message: '임시 저장되지 않은 내용은 사라집니다.',\r\n            okButton: '나가기',\r\n            cancelButton: '잠시만요!',\r\n          })\r\n          ok ? next() : next(false)\r\n        }\r\n      })\r\n\r\n      return {\r\n        isMobile,\r\n        Dialog,\r\n        plugins,\r\n        IMAGE_URL,\r\n        menuState,\r\n        postState,\r\n        fileState,\r\n        onChangeCanLeavePage,\r\n        onChangeMainMenu,\r\n        onChangeSubMenu,\r\n        onChangeCategory,\r\n        onChangeIsPublic,\r\n        onUpdatePost,\r\n        onUploadImages,\r\n        onInsertImage,\r\n        onClearImages,\r\n        onDeleteImage,\r\n        onSelectImage,\r\n      }\r\n    },\r\n  })\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  .editor {\r\n    .wrap_select_toggle {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      @include mobile {\r\n        flex-direction: column;\r\n        align-items: flex-end;\r\n      }\r\n\r\n      .select {\r\n        display: flex;\r\n        flex-direction: row;\r\n        width: 90%;\r\n\r\n        @include mobile {\r\n          flex-direction: column;\r\n          width: 100%;\r\n        }\r\n\r\n        div {\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          border: 1px solid #ddd;\r\n          width: 27rem;\r\n          border-radius: 3.2rem;\r\n          font-size: 1.4rem;\r\n          margin-right: 2.4rem;\r\n          padding: 0 2.4rem;\r\n\r\n          @include mobile {\r\n            width: 100%;\r\n            margin-right: 0;\r\n            margin-bottom: 1.6rem;\r\n          }\r\n\r\n          select {\r\n            width: 100%;\r\n            font-size: 1.4rem;\r\n            color: var(--text-light);\r\n            height: 4.8rem;\r\n            background-color: transparent;\r\n            font-family: 'Roboto', 'Noto Sans KR', sans-serif;\r\n            text-transform: uppercase;\r\n          }\r\n\r\n          &:last-child select > option {\r\n            text-transform: none;\r\n          }\r\n        }\r\n      }\r\n\r\n      .wrap_toggle {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: flex-end;\r\n        width: 10%;\r\n\r\n        @include mobile {\r\n          width: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    .wrap_title_file-add-btn {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n      border: 1px solid #ddd;\r\n      margin: 2.4rem 0 1.6rem;\r\n      border-radius: 3.2rem;\r\n      width: 100%;\r\n      height: 4.8rem;\r\n      padding: 0 2.4rem;\r\n\r\n      @include mobile {\r\n        margin: 1.6rem 0;\r\n      }\r\n\r\n      .title {\r\n        width: 80%;\r\n\r\n        input {\r\n          color: var(--text-light);\r\n          font-size: 1.4rem;\r\n          width: 100%;\r\n        }\r\n\r\n        input::placeholder {\r\n          color: var(--text-light);\r\n          font-size: 1.4rem;\r\n        }\r\n      }\r\n\r\n      .images_add_btn {\r\n        width: 20%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        margin: 0 0 0 3.2rem;\r\n\r\n        label.upload_label {\r\n          font-size: 1.2rem;\r\n          line-height: 1.8rem;\r\n          cursor: pointer;\r\n          text-transform: uppercase;\r\n          letter-spacing: 0.1rem;\r\n          color: var(--text-light);\r\n          position: relative;\r\n          padding: 0 0 0 3.2rem;\r\n\r\n          &::before {\r\n            content: '';\r\n            position: absolute;\r\n            left: 0;\r\n            width: 0.01rem;\r\n            height: 1.6rem;\r\n            background-color: var(--border-dark);\r\n          }\r\n        }\r\n\r\n        input#upload_input {\r\n          display: none;\r\n        }\r\n      }\r\n    }\r\n\r\n    .content {\r\n      display: flex;\r\n      flex-direction: row;\r\n\r\n      textarea,\r\n      .markdown {\r\n        width: 50%;\r\n        min-height: 48rem;\r\n        border-radius: 3.2rem;\r\n        border: 1px solid #ddd;\r\n        padding: 2.4rem;\r\n        font-size: 1.4rem;\r\n        color: var(--text-light);\r\n      }\r\n\r\n      textarea {\r\n        margin: 0 2.4rem 0 0;\r\n        resize: vertical;\r\n\r\n        @include mobile_all {\r\n          width: 100%;\r\n          margin: 0;\r\n        }\r\n      }\r\n\r\n      textarea::placeholder {\r\n        color: var(--text-light);\r\n        font-size: 1.4rem;\r\n      }\r\n\r\n      .markdown {\r\n        @include mobile_all {\r\n          display: none;\r\n        }\r\n      }\r\n    }\r\n\r\n    .images {\r\n      margin: 0 0 -1.2rem 0;\r\n      ul {\r\n        display: flex;\r\n        flex-direction: row;\r\n        flex-wrap: wrap;\r\n        margin: calc(3.2rem - 1.2rem) 0 0;\r\n\r\n        li {\r\n          width: 7.4rem;\r\n          height: calc(7.4rem + 1.6rem);\r\n          margin: 0rem 2.4rem 0 0;\r\n\r\n          .wrap_thumbnail {\r\n            position: relative;\r\n            img {\r\n              width: 100%;\r\n              height: 7.4rem;\r\n              border-radius: 2.4rem;\r\n              border: 2px solid #ddd;\r\n              object-fit: cover;\r\n              padding: 0.2rem;\r\n\r\n              &.selected_thumbnail {\r\n                border: 2px solid var(--primary-dark);\r\n              }\r\n            }\r\n            .image_del_btn {\r\n              position: absolute;\r\n              bottom: -0.6rem;\r\n              right: -0.6rem;\r\n              color: var(--secondary-dark);\r\n\r\n              i {\r\n                font-size: 2.2rem;\r\n              }\r\n\r\n              .material-symbols-outlined {\r\n                font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 48;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .wrap_btns {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: flex-end;\r\n\r\n      .wrap_image_btns {\r\n        display: flex;\r\n        align-items: center;\r\n        margin: 1.6rem 0 2rem;\r\n        justify-content: flex-start;\r\n        width: 100%;\r\n\r\n        .btn_image_clear {\r\n          margin: 0 0 0 1.2rem;\r\n        }\r\n      }\r\n\r\n      /*\r\n\r\n      .wrap_right {\r\n        width: 50%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n\r\n        .wrap_isLoading {\r\n          display: flex;\r\n          align-items: center;\r\n          margin: 0 2.4rem 0 0;\r\n\r\n          .isLoading {\r\n            display: flex;\r\n            align-items: center;\r\n            color: var(--text-light);\r\n          }\r\n          .isLoading-enter-active,\r\n          .isLoading-leave-active {\r\n            transition: opacity 5s ease;\r\n          }\r\n\r\n          .isLoading-enter-from,\r\n          .isLoading-leave-to {\r\n            opacity: 0;\r\n          }\r\n        }\r\n\r\n\r\n        .wrap_auto-save {\r\n          display: flex;\r\n          align-items: center;\r\n          margin: 0 0 0 2.4rem;\r\n\r\n          #auto-save {\r\n            width: 1.6rem;\r\n            height: 1.6rem;\r\n          }\r\n          label {\r\n            margin: 0 2.4rem 0 1.2rem;\r\n            font-size: 1.3rem;\r\n            color: var(--text-dark);\r\n          }\r\n        }\r\n  \r\n      }\r\n      */\r\n    }\r\n  }\r\n</style>\r\n","import { render } from \"./Editor.vue?vue&type=template&id=31ef85ed&scoped=true\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=31ef85ed&lang=scss&rel=stylesheet%2Fscss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\kimku\\\\OneDrive\\\\바탕 화면\\\\frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-31ef85ed\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Editor.vue?vue&type=style&index=0&id=31ef85ed&lang=scss&rel=stylesheet%2Fscss&scoped=true\""],"sourceRoot":""}