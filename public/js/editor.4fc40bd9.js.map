{"version":3,"sources":["webpack:///./src/views/post/Editor.vue?85ca","webpack:///./src/views/post/Editor.vue","webpack:///./src/views/post/Editor.vue?6e95"],"names":["class","_createElementVNode","selected","disabled","hidden","value","for","_hoisted_25","_createElementBlock","required","onChange","_ctx","_hoisted_5","_Fragment","_renderList","Object","keys","menus","main","key","_hoisted_6","mainMenus","length","_hoisted_9","menu","_id","sub","_hoisted_10","subMenu","categories","_hoisted_13","category","_hoisted_14","_createVNode","_component_Toggle","isPublic","onUpdateIsPublic","type","title","$event","placeholder","onfocus","onblur","_hoisted_19","ref","id","onClick","UPLOAD_INPUT_EL","multiple","content","onKeydown","_component_markdown","source","plugins","breaks","xhtmlOut","typographer","files","file","index","serverFileName","src","fileIndex","_component_Button","size","borderColor","rounded","full","isLoading","onOnClick","bgColor","custom","_Transition","name","_hoisted_32","percentage","defineComponent","components","Toggle","Markdown","setup","route","useRoute","go","push","useRouter","state","dispatch","useStore","DIALOG_EL","inject","TOAST_EL","canLeavePage","isMobile","useMedia","plugin","MarkdownEmoji","IMAGE_URL","process","postId","draftId","menuState","reactive","computed","loading","postState","images","fileState","map","thumbnail","fileId","fileName","fileUrl","onChangeMainMenu","event","target","document","body","querySelector","selectedIndex","onChangeSubMenu","find","onChangeCategory","onChangeIsPublic","Boolean","onUpdateDraft","async","formData","FormData","open","payload","forEach","append","success","draft","onUpdatePost","post","query","onUploadImages","values","Array","isArray","onSelectImage","onDeleteImage","imageId","idx","findIndex","filter","f","onInsertImage","textarea","start","substring","selectionStart","end","selectionEnd","innerText","focus","onClearImages","onChangeCanLeavePage","bool","unloadEvent","preventDefault","returnValue","setInitData","temp","autoSave","setInterval","watch","reduce","acc","searchedMenu","flush","onBeforeMount","error","alert","onMounted","window","addEventListener","onUnmounted","removeEventListener","clearInterval","onBeforeRouteLeave","to","from","next","ok","show","message","okButton","cancelButton","__exports__","render"],"mappings":"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","file":"js/editor.4fc40bd9.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Editor.vue?vue&type=style&index=0&id=568fbec7&lang=scss&rel=stylesheet%2Fscss&scoped=true\"","<template>\r\n  <div class=\"editor\">\r\n    <div class=\"wrap_select_toggle\">\r\n      <div class=\"select\">\r\n\r\n        <!-- Main menu select box -->\r\n        <div class=\"main\">\r\n          <select required @change=\"onChangeMainMenu\">\r\n            <option selected disabled hidden value=\"\">main menu</option>\r\n            <option v-for=\"main in Object.keys(menuState.menus)\" :key=\"main\" :value=\"main\">{{ main }}</option>\r\n          </select>\r\n        </div>\r\n\r\n        <!-- Sub menu select box -->\r\n        <div class=\"sub\">\r\n          <select required :disabled=\"!menuState.mainMenus.length\" @change=\"onChangeSubMenu\">\r\n            <option selected disabled hidden value=\"\">sub menu</option>\r\n            <option v-for=\"menu in menuState.mainMenus\" :key=\"menu?._id\" :value=\"menu?.sub\">{{ menu?.sub }}</option>\r\n          </select>\r\n        </div>\r\n\r\n        <!-- Category select box -->\r\n        <div class=\"category\">\r\n          <select :disabled=\"!menuState.subMenu.categories\" @change=\"onChangeCategory\">\r\n            <option selected disabled hidden value=\"\">category</option>\r\n            <option v-for=\"category in menuState.subMenu.categories\" :key=\"category\" :value=\"category\">\r\n              {{ category }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Public scope toggle button -->\r\n      <div class=\"wrap_toggle\">\r\n        <Toggle :isPublic=\"postState.isPublic\" @updateIsPublic=\"onChangeIsPublic\" />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Title and File button -->\r\n    <div class=\"wrap_title_file-add-btn\">\r\n      <div class=\"title\">\r\n        <input\r\n          type=\"text\"\r\n          v-model=\"postState.title\"\r\n          placeholder=\"제목을 입력하세요.\"\r\n          onfocus=\"this.placeholder=''\"\r\n          onblur=\"this.placeholder='제목을 입력하세요.'\"\r\n        />\r\n      </div>\r\n      <div class=\"images_add_btn\">\r\n        <label for=\"upload_input\" class=\"upload_label\">사진 불러오기</label>\r\n        <input\r\n          ref=\"UPLOAD_INPUT_EL\"\r\n          type=\"file\"\r\n          id=\"upload_input\"\r\n          @change=\"onUploadImages\"\r\n          @click=\"$refs.UPLOAD_INPUT_EL.value = ''\"\r\n          multiple\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Content -->\r\n    <div class=\"content\">\r\n      <textarea\r\n        id=\"content-el\"\r\n        v-model=\"postState.content\"\r\n        placeholder=\"당신의 이야기를 적어보세요...\"\r\n        @keydown=\"onChangeCanLeavePage(false)\"\r\n      />\r\n      <markdown\r\n        class=\"markdown\"\r\n        :source=\"postState.content\"\r\n        :plugins=\"plugins\"\r\n        :breaks=\"true\"\r\n        :xhtmlOut=\"true\"\r\n        :typographer=\"true\"\r\n      />\r\n    </div>\r\n\r\n    <!-- Images -->\r\n    <div class=\"images\" v-if=\"fileState.files.length\">\r\n      <ul>\r\n        <li v-for=\"(file, index) in fileState.files\" :key=\"file.serverFileName\">\r\n          <div class=\"wrap_thumbnail\">\r\n            <img\r\n              :src=\"`${IMAGE_URL}${file.serverFileName}`\"\r\n              :class=\"fileState.fileIndex === index ? 'selected_thumbnail' : ''\"\r\n              @click=\"onSelectImage(file, index)\"\r\n            />\r\n            <button class=\"image_del_btn\" @click=\"onDeleteImage(file, index)\">\r\n              <i class=\"material-symbols-outlined\"> do_not_disturb_on </i>\r\n            </button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <!-- Buttons -->\r\n    <div class=\"wrap_btns\">\r\n      <div class=\"wrap_image_btns\">\r\n        <Button\r\n          v-show=\"fileState.files.length\"\r\n          class=\"btn_image_insert\"\r\n          :content=\"'사진 첨부'\"\r\n          :size=\"'md'\"\r\n          :borderColor=\"'primary-dark'\"\r\n          :rounded=\"true\"\r\n          :full=\"isMobile ? true : false\"\r\n          :disabled=\"menuState.isLoading\"\r\n          @onClick=\"onInsertImage\"\r\n        ></Button>\r\n        <Button\r\n          v-show=\"fileState.files.length\"\r\n          class=\"btn_image_clear\"\r\n          :content=\"'사진 모두 제거'\"\r\n          :size=\"'md'\"\r\n          :borderColor=\"'primary-dark'\"\r\n          :rounded=\"true\"\r\n          :full=\"isMobile ? true : false\"\r\n          :disabled=\"menuState.isLoading\"\r\n          @onClick=\"onClearImages\"\r\n        ></Button>\r\n      </div>\r\n\r\n      <Button\r\n        class=\"btn_submit\"\r\n        :content=\"'글 등록'\"\r\n        :size=\"'md'\"\r\n        :bgColor=\"'primary-dark'\"\r\n        :custom=\"true\"\r\n        :rounded=\"true\"\r\n        :full=\"isMobile ? true : false\"\r\n        :disabled=\"menuState.isLoading\"\r\n        @onClick=\"onChangeCanLeavePage(true), onUpdatePost()\"\r\n      ></Button>\r\n\r\n      <!-- Loading progress -->\r\n      <div class=\"wrap_right\">\r\n        <div class=\"wrap_isLoading\">\r\n          <Transition name=\"isLoading\">\r\n            <span class=\"isLoading\" v-if=\"menuState.isLoading\">\r\n              <i class=\"material-symbols-outlined\">hourglass_empty</i>{{ `자동 저장중...${menuState.percentage}` }}\r\n            </span>\r\n          </Transition>\r\n        </div>\r\n      </div>\r\n      \r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { defineComponent, inject, ref, reactive, computed, watch, onBeforeMount, onMounted, onUnmounted } from 'vue'\r\n  import { useRouter, useRoute, onBeforeRouteLeave } from 'vue-router'\r\n  import { useStore } from 'vuex'\r\n  import { useMedia } from '../../common/mediaQuery'\r\n  import Markdown from 'vue3-markdown-it'\r\n  import MarkdownEmoji from 'markdown-it-emoji'\r\n  import Toggle from '../../components/ui/Toggle.vue'\r\n  import 'highlight.js/styles/atom-one-dark.css'\r\n\r\n  export default defineComponent({\r\n    name: 'editor',\r\n    components: {\r\n      Toggle,\r\n      Markdown,\r\n    },\r\n    setup() {\r\n      const route = useRoute()\r\n      const { go, push } = useRouter()\r\n      const { state, dispatch } = useStore()\r\n\r\n      const DIALOG_EL = inject('DIALOG_EL')\r\n      const TOAST_EL = inject('TOAST_EL')\r\n\r\n      let canLeavePage = true\r\n      const isMobile = useMedia('only screen and (max-width: 767px)')\r\n\r\n      const plugins = ref([{ plugin: MarkdownEmoji }])\r\n      const IMAGE_URL = ref(process.env.VUE_APP_IMAGE_URL)\r\n\r\n      const temp = ref(false)\r\n      const postId = ref(null)\r\n      const draftId = ref(null)\r\n\r\n      const menuState = reactive({\r\n        isLoading: computed(() => state.loading.isLoading),\r\n        percentage: computed(() => state.loading.percentage),\r\n        menus: computed(() => state.menu.menus),\r\n        mainMenus: [],\r\n        subMenu: {},\r\n      })\r\n\r\n      const postState = reactive({\r\n        menu: '',\r\n        title: '',\r\n        content: '',\r\n        category: '기타',\r\n        isPublic: true,\r\n        images: computed(() => fileState.files.map(({ _id }) => _id)),\r\n        thumbnail: computed(() => fileState.fileId),\r\n      })\r\n\r\n      const fileState = reactive({\r\n        files: [],\r\n        fileId: '',\r\n        fileName: '',\r\n        fileUrl: IMAGE_URL.value,\r\n        fileIndex: 0,\r\n      })\r\n\r\n      const onChangeMainMenu = (event) => {\r\n        menuState.mainMenus = menuState.menus[event.target.value]\r\n        document.body.querySelector('div.sub select').selectedIndex = 0\r\n        document.body.querySelector('div.category select').selectedIndex = 0\r\n      }\r\n\r\n      const onChangeSubMenu = (event) => {\r\n        menuState.subMenu = menuState.mainMenus.find((menu) => menu.sub === event.target.value)\r\n        postState.menu = menuState.subMenu?._id\r\n        document.body.querySelector('div.category select').selectedIndex = 0\r\n      }\r\n\r\n      const onChangeCategory = (event) => {\r\n        postState.category = event.target.value\r\n      }\r\n\r\n      const onChangeIsPublic = (state) => {\r\n        postState.isPublic = Boolean(state)\r\n      }\r\n\r\n      const onUpdateDraft = async (formData = new FormData()) => {\r\n        if (!postState.menu) return TOAST_EL.value.open('error', '게시글을 삽입할 메뉴를 선택해야 합니다.')\r\n\r\n        const { ...payload } = postState\r\n        Object.keys(payload).forEach((key) => formData.append(key, payload[key]))\r\n\r\n        const { success, draft, images } = draftId.value\r\n          ? await dispatch('draft/updateDraft', { draftId: draftId.value, payload: formData })\r\n          : await dispatch('draft/createDraft', formData)\r\n\r\n        success ? TOAST_EL.value.open('success', '임시저장 되었습니다.') : TOAST_EL.value.open('error', '임시저장에 실패하였습니다')\r\n\r\n        draftId.value = draft?._id\r\n\r\n        return { success, images }\r\n      }\r\n\r\n      const onUpdatePost = async () => {\r\n        if (!postState.menu) return TOAST_EL.value.open('error', '게시글을 삽입할 메뉴를 선택해야 합니다.')\r\n\r\n        const { ...payload } = postState\r\n        const { success, post } = postId.value\r\n          ? await dispatch('post/updatePost', { postId, payload })\r\n          : await dispatch('post/createPost', payload)\r\n\r\n        if (success && canLeavePage) {\r\n          push({ name: 'post', query: { id: post._id } })\r\n        }\r\n      }\r\n\r\n      const onUploadImages = async (event) => {\r\n        if (!event.target.files.length) return\r\n        if (!postState.menu) return TOAST_EL.value.open('error', '게시글을 삽입할 메뉴를 선택해야 합니다.')\r\n\r\n        const formData = new FormData()\r\n        Object.values(event.target.files).forEach((file) => formData.append('images', file))\r\n\r\n        const { success, images } = postId.value\r\n          ? await dispatch('post/updatePost', { postId: postId.value, payload: formData })\r\n          : await onUpdateDraft(formData)\r\n\r\n        if (success && Array.isArray(images)) {\r\n          fileState.files.push(...images)\r\n          onSelectImage(fileState.files[0], 0)\r\n        }\r\n      }\r\n\r\n      const onDeleteImage = async (file) => {\r\n        if (!file?._id) return\r\n\r\n        const { success } = postId.value\r\n          ? await dispatch('post/deleteFile', { postId: postId.value, imageId: file._id })\r\n          : await dispatch('draft/deleteFile', { draftId: draftId.value, imageId: file._id })\r\n\r\n        const idx = fileState.files.findIndex(({ _id }) => _id === file._id)\r\n        if (success && idx !== -1) fileState.files = fileState.files.filter((f, index) => index !== idx)\r\n      }\r\n\r\n      const onSelectImage = (file, index) => {\r\n        if (!file) return\r\n        fileState.fileId = file._id\r\n        fileState.fileName = file.serverFileName\r\n        fileState.fileUrl = fileState.fileUrl + fileState.fileName\r\n        fileState.fileIndex = index\r\n      }\r\n\r\n      const onInsertImage = () => {\r\n        let textarea = document.body.querySelector('#content-el')\r\n        let start = textarea.value.substring(0, textarea.selectionStart)\r\n        let end = textarea.value.substring(textarea.selectionEnd, textarea.value.length)\r\n\r\n        const innerText = `!` + `[` + `]` + `(` + `${fileState.fileUrl}` + `)\\n`\r\n        postState.content = start + innerText + end\r\n        textarea.focus()\r\n      }\r\n\r\n      const onClearImages = () => {\r\n        fileState.files = []\r\n      }\r\n\r\n      const onChangeCanLeavePage = (bool) => {\r\n        canLeavePage = bool\r\n      }\r\n\r\n      const unloadEvent = (event) => {\r\n        if (!canLeavePage) {\r\n          event.preventDefault()\r\n          event.returnValue = ''\r\n        }\r\n      }\r\n\r\n      const setInitData = (post = {}, temp = false) => {\r\n        const { _id, menu, category, title, content, isPublic, images, thumbnail } = post\r\n\r\n        if (temp) draftId.value = _id\r\n        else postId.value = _id\r\n\r\n        postState.menu = menu\r\n        postState.title = title\r\n        postState.content = content\r\n        postState.category = category\r\n        postState.isPublic = isPublic\r\n        fileState.files = Array.isArray(images) ? images : []\r\n\r\n        const idx = fileState.files.findIndex(({ _id }) => _id === thumbnail)\r\n        if (thumbnail && idx !== -1) {\r\n          onSelectImage(fileState.files[idx], idx)\r\n        }\r\n      }\r\n\r\n      const autoSave = route.query.id ? setInterval(onUpdatePost, 1000 * 60 * 5) : setInterval(onUpdateDraft, 1000 * 60 * 5)\r\n\r\n      watch(\r\n        () => postState.menu,\r\n        () => {\r\n          const { menu, category } = postState\r\n\r\n          if (menu) {\r\n            const { main, sub } = Object.keys(menuState.menus).reduce((acc, key) => {\r\n              const searchedMenu = menuState.menus[key].find(({ _id }) => _id === menu)\r\n              if (searchedMenu) acc = { ...searchedMenu }\r\n              return acc\r\n            }, {})\r\n            \r\n            if (main) {\r\n              document.body.querySelector('div.main select').value = main\r\n              menuState.mainMenus = menuState.menus[main]\r\n            }\r\n            if (sub) {\r\n              document.body.querySelector('div.sub select').value = sub\r\n              menuState.subMenu = menuState.mainMenus.find((menu) => menu.sub === sub)\r\n            }\r\n            if (category) document.body.querySelector('div.category select').value = category\r\n          }\r\n        },\r\n        { flush: 'post' }\r\n      )\r\n\r\n      onBeforeMount(async () => {\r\n        if (route.query.id) {\r\n          if (state.post.post) return setInitData(state.post.post)\r\n\r\n          const { success, post, error } = await dispatch('post/getPost', { postId: route.query.id })\r\n          if (!success) {\r\n            alert(error)\r\n            return go(-1)\r\n          }\r\n\r\n          setInitData(post)\r\n        }\r\n      })\r\n\r\n      onMounted(() => {\r\n        window.addEventListener('beforeunload', unloadEvent)\r\n      })\r\n\r\n      onUnmounted(async () => {\r\n        window.removeEventListener('beforeunload', unloadEvent)\r\n        clearInterval(autoSave)\r\n      })\r\n\r\n      onBeforeRouteLeave(async (to, from, next) => {\r\n        if (canLeavePage) next()\r\n        else {\r\n          const ok = await DIALOG_EL.value.show({\r\n            title: '현재 페이지에서 나가시겠습니까?',\r\n            message: '임시 저장되지 않은 내용은 사라집니다.',\r\n            okButton: '나가기',\r\n            cancelButton: '잠시만요!',\r\n          })\r\n          ok ? next() : next(false)\r\n        }\r\n      })\r\n\r\n      return {\r\n        plugins,\r\n        isMobile,\r\n        IMAGE_URL,\r\n        menuState,\r\n        postState,\r\n        fileState,\r\n        onChangeCanLeavePage,\r\n        onChangeMainMenu,\r\n        onChangeSubMenu,\r\n        onChangeCategory,\r\n        onChangeIsPublic,\r\n        onUpdatePost,\r\n        onUploadImages,\r\n        onInsertImage,\r\n        onClearImages,\r\n        onDeleteImage,\r\n        onSelectImage,\r\n      }\r\n    },\r\n  })\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  .editor {\r\n    .wrap_select_toggle {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      @include mobile {\r\n        flex-direction: column;\r\n        align-items: flex-end;\r\n      }\r\n\r\n      .select {\r\n        display: flex;\r\n        flex-direction: row;\r\n        width: 90%;\r\n\r\n        @include mobile {\r\n          flex-direction: column;\r\n          width: 100%;\r\n        }\r\n\r\n        div {\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          border: 1px solid #ddd;\r\n          width: 27rem;\r\n          border-radius: 3.2rem;\r\n          font-size: 1.4rem;\r\n          margin-right: 2.4rem;\r\n          padding: 0 2.4rem;\r\n\r\n          @include mobile {\r\n            width: 100%;\r\n            margin-right: 0;\r\n            margin-bottom: 1.6rem;\r\n          }\r\n\r\n          select {\r\n            width: 100%;\r\n            font-size: 1.4rem;\r\n            color: var(--text-light);\r\n            height: 4.8rem;\r\n            background-color: transparent;\r\n            font-family: 'Roboto', 'Noto Sans KR', sans-serif;\r\n            text-transform: uppercase;\r\n          }\r\n\r\n          &:last-child select > option {\r\n            text-transform: none;\r\n          }\r\n        }\r\n      }\r\n\r\n      .wrap_toggle {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: flex-end;\r\n        width: 10%;\r\n\r\n        @include mobile {\r\n          width: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    .wrap_title_file-add-btn {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n      border: 1px solid #ddd;\r\n      margin: 2.4rem 0 1.6rem;\r\n      border-radius: 3.2rem;\r\n      width: 100%;\r\n      height: 4.8rem;\r\n      padding: 0 2.4rem;\r\n\r\n      @include mobile {\r\n        margin: 1.6rem 0;\r\n      }\r\n\r\n      .title {\r\n        width: 80%;\r\n\r\n        input {\r\n          color: var(--text-light);\r\n          font-size: 1.4rem;\r\n          width: 100%;\r\n        }\r\n\r\n        input::placeholder {\r\n          color: var(--text-light);\r\n          font-size: 1.4rem;\r\n        }\r\n      }\r\n\r\n      .images_add_btn {\r\n        width: 20%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        margin: 0 0 0 3.2rem;\r\n\r\n        label.upload_label {\r\n          font-size: 1.2rem;\r\n          line-height: 1.8rem;\r\n          cursor: pointer;\r\n          text-transform: uppercase;\r\n          letter-spacing: 0.1rem;\r\n          color: var(--text-light);\r\n          position: relative;\r\n          padding: 0 0 0 3.2rem;\r\n\r\n          &::before {\r\n            content: '';\r\n            position: absolute;\r\n            left: 0;\r\n            width: 0.01rem;\r\n            height: 1.6rem;\r\n            background-color: var(--border-dark);\r\n          }\r\n        }\r\n\r\n        input#upload_input {\r\n          display: none;\r\n        }\r\n      }\r\n    }\r\n\r\n    .content {\r\n      display: flex;\r\n      flex-direction: row;\r\n\r\n      textarea,\r\n      .markdown {\r\n        width: 50%;\r\n        min-height: 48rem;\r\n        border-radius: 3.2rem;\r\n        border: 1px solid #ddd;\r\n        padding: 2.4rem;\r\n        font-size: 1.4rem;\r\n        color: var(--text-light);\r\n      }\r\n\r\n      textarea {\r\n        margin: 0 2.4rem 0 0;\r\n        resize: vertical;\r\n\r\n        @include mobile_all {\r\n          width: 100%;\r\n          margin: 0;\r\n        }\r\n      }\r\n\r\n      textarea::placeholder {\r\n        color: var(--text-light);\r\n        font-size: 1.4rem;\r\n      }\r\n\r\n      .markdown {\r\n        @include mobile_all {\r\n          display: none;\r\n        }\r\n      }\r\n    }\r\n\r\n    .images {\r\n      margin: 0 0 -1.2rem 0;\r\n      ul {\r\n        display: flex;\r\n        flex-direction: row;\r\n        flex-wrap: wrap;\r\n        margin: calc(3.2rem - 1.2rem) 0 0;\r\n\r\n        li {\r\n          width: 7.4rem;\r\n          height: calc(7.4rem + 1.6rem);\r\n          margin: 0rem 2.4rem 0 0;\r\n\r\n          .wrap_thumbnail {\r\n            position: relative;\r\n            img {\r\n              width: 100%;\r\n              height: 7.4rem;\r\n              border-radius: 2.4rem;\r\n              border: 2px solid #ddd;\r\n              object-fit: cover;\r\n              padding: 0.2rem;\r\n\r\n              &.selected_thumbnail {\r\n                border: 2px solid var(--primary-dark);\r\n              }\r\n            }\r\n            .image_del_btn {\r\n              position: absolute;\r\n              bottom: -0.6rem;\r\n              right: -0.6rem;\r\n              color: var(--secondary-dark);\r\n\r\n              i {\r\n                font-size: 2.2rem;\r\n              }\r\n\r\n              .material-symbols-outlined {\r\n                font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 48;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .wrap_btns {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: flex-end;\r\n\r\n      .wrap_image_btns {\r\n        display: flex;\r\n        align-items: center;\r\n        margin: 1.6rem 0 2rem;\r\n        justify-content: flex-start;\r\n        width: 100%;\r\n\r\n        .btn_image_clear {\r\n          margin: 0 0 0 1.2rem;\r\n        }\r\n      }\r\n\r\n      /*\r\n\r\n      .wrap_right {\r\n        width: 50%;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n\r\n        .wrap_isLoading {\r\n          display: flex;\r\n          align-items: center;\r\n          margin: 0 2.4rem 0 0;\r\n\r\n          .isLoading {\r\n            display: flex;\r\n            align-items: center;\r\n            color: var(--text-light);\r\n          }\r\n          .isLoading-enter-active,\r\n          .isLoading-leave-active {\r\n            transition: opacity 5s ease;\r\n          }\r\n\r\n          .isLoading-enter-from,\r\n          .isLoading-leave-to {\r\n            opacity: 0;\r\n          }\r\n        }\r\n\r\n\r\n        .wrap_auto-save {\r\n          display: flex;\r\n          align-items: center;\r\n          margin: 0 0 0 2.4rem;\r\n\r\n          #auto-save {\r\n            width: 1.6rem;\r\n            height: 1.6rem;\r\n          }\r\n          label {\r\n            margin: 0 2.4rem 0 1.2rem;\r\n            font-size: 1.3rem;\r\n            color: var(--text-dark);\r\n          }\r\n        }\r\n  \r\n      }\r\n      */\r\n    }\r\n  }\r\n</style>\r\n","import { render } from \"./Editor.vue?vue&type=template&id=568fbec7&scoped=true\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=568fbec7&lang=scss&rel=stylesheet%2Fscss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\kimku\\\\OneDrive\\\\바탕 화면\\\\frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-568fbec7\"]])\n\nexport default __exports__"],"sourceRoot":""}